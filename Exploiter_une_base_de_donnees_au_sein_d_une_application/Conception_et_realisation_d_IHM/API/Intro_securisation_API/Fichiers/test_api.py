import requests

# Login endpoint

login_url = "http://127.0.0.1:5000//login" #Remplacez l'adresse et port si différent sur votre PC
login_data = {"username": "grogu@grogu.com", "password": "grogu"}

# Send login request
response = requests.post(login_url, data=login_data)

# Check if login was successful
if response.status_code == 200:
    # Get access token from response
    token = response.json()["access_token"]
    
    # Set header with access token
    headers = {"Authorization": f"Bearer {token}"}
    
    # Protected endpoint
    protected_url = "http://127.0.0.1:5000//protected" #Remplacez l'adresse et port si différent sur votre PC
    
    # Send request with access token
    response = requests.get(protected_url, headers=headers)
    
    # Check if request was successful
    if response.status_code == 200:
        print(response.json())
    else:
        print("Protected resource not available", response.status_code)
else:
    print("Login failed")
