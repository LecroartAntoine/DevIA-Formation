from PyQt5 import QtCore
import speech_recognition as sr

######################### Thread Qt de traitement du texte par l'API openAI ###################################
class SpeechThread(QtCore.QThread):
    finished = QtCore.pyqtSignal(object) # Signal à envoyer quand le traitement est fini, ici un json.
    
    def __init__(self, parent=None):
        super().__init__(parent) # initialisation du Thread

    def run(self):
        r = sr.Recognizer()
        r.energy_threshold = 600
        micro = sr.Microphone()
        with micro as source:

            audio_data = r.listen(source)

        result = r.recognize_google(audio_data, language="fr-FR")

        self.finished.emit(result) # Renvoie de la réponse

        
